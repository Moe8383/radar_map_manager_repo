# Radar Map Manager (RMM)

![Logo](logo.png)

[![hacs_badge](https://img.shields.io/badge/HACS-Custom-41BDF5.svg)](https://github.com/hacs/integration)

> ğŸ‡ºğŸ‡¸ **English User?** [Click here for English Documentation](README.md)

**Radar Map Manager (RMM)** æ˜¯ä¸“ä¸º Home Assistant æ‰“é€ çš„æ¯«ç±³æ³¢é›·è¾¾å¯è§†åŒ–ä¸æ•°æ®èåˆé›†æˆã€‚

å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªæˆ·å‹å›¾å¡ç‰‡ï¼Œæ›´æ˜¯ä¸€ä¸ª**ç©ºé—´æ„ŸçŸ¥å¼•æ“**ã€‚RMM èƒ½å°†å®¶ä¸­åˆ†æ•£çš„å¤šä¸ªæ¯«ç±³æ³¢é›·è¾¾çš„æ•°æ®ç»Ÿä¸€æ˜ å°„åˆ°æ‚¨çš„å¤šä¸ªæˆ·å‹å›¾ä¸Šï¼Œå®ç°å…¨å±‹äººå‘˜å®šä½è¿½è¸ªã€è½¨è¿¹å¯è§†åŒ–ä»¥åŠåŸºäºç²¾ç¡®åæ ‡çš„è‡ªåŠ¨åŒ–è§¦å‘ã€‚

> ğŸš€ **V1.0.0 æ­£å¼å‘å¸ƒï¼** 

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. ğŸ¯ æ‰€è§å³æ‰€å¾—çš„å¯è§†åŒ–ç¼–è¾‘å™¨
æŠ›å¼ƒç¹ççš„ YAML åæ ‡è®¡ç®—ï¼RMM æä¾›äº†ä¸€ä¸ªäº¤äº’å¼çš„å‰ç«¯ç¼–è¾‘å™¨ï¼š
* **åŒæ¨¡å¼æ”¯æŒ**ï¼šæ”¯æŒ**é…ç½®æ¨¡å¼ (config)** å’Œ **å±•ç¤ºæ¨¡å¼ (read_only)** ä¸¤ç§æ¨¡å¼ï¼Œé…ç½®ã€å±•ç¤ºä¸¤ä¸è¯¯ã€‚
* **å¤šæˆ·å‹/æ¥¼å±‚æ”¯æŒ**ï¼šæ”¯æŒ**å¤šæˆ·å‹ï¼ˆmap_groupï¼‰** è½»æ¾ç®¡ç†å¤šä¸ªæ¥¼å±‚å’Œåœ°ç‚¹ï¼Œä¸ºä½ çš„å®¶åº­ã€åŠå…¬å®¤è®¾ç½®ç‹¬ç«‹çš„è§†å›¾ã€‚
* **çµæ´»è‡ªç”±çš„é›·è¾¾é…ç½®**ï¼šç›´æ¥åœ¨æˆ·å‹å›¾ä¸Šæ‹–æ‹½é›·è¾¾ä½ç½®ï¼Œæ”¯æŒé›·è¾¾çš„æ—‹è½¬ã€ç¼©æ”¾å’Œé•œåƒç¿»è½¬ï¼Œä¸€ç«™å¼ç®¡ç†é›·è¾¾ã€‚
* **è‡ªåŠ¨å®šä½ç¼©æ”¾**ï¼šé€šè¿‡freezeåŠŸèƒ½ï¼Œå¯ä»¥å¯è§†åŒ–çš„å®šä½é›·è¾¾ç›®æ ‡åœ¨æˆ·å‹å›¾ä¸Šçš„ç›¸å¯¹ä½ç½®ï¼Œè®©ä½ è½»æ¾è°ƒæ•´é›·è¾¾ç¼©æ”¾ï¼Œå‘Šåˆ«å¿™çŒœã€‚
* **é›·è¾¾å®‰è£…æ–¹å¼æ”¯æŒ**ï¼šå®Œç¾æ”¯æŒ **ä¾§è£… (Side Mount)** å’Œ **é¡¶è£… (Ceiling Mount)** é›·è¾¾ã€‚

### 2. ğŸŒ å¤šé›·è¾¾æ•°æ®èåˆ (Sensor Fusion)
RMM çš„ç›®æ ‡èåˆå¼•æ“èƒ½å°†å¤šä¸ªé›·è¾¾çš„ç›®æ ‡ç‚¹ç»Ÿä¸€åˆ°ä¸€ä¸ªåæ ‡ç³»ä¸­ï¼š
* **è‡ªåŠ¨èšç±»**ï¼šå½“å¤šä¸ªé›·è¾¾æ¢æµ‹åˆ°åŒä¸€ä¸ªäººæ—¶ï¼Œè‡ªåŠ¨åˆå¹¶ä¸ºä¸€ä¸ªç›®æ ‡ï¼Œé¿å…â€œå½±åˆ†èº«â€ï¼ŒèåˆèŒƒå›´æ”¯æŒè‡ªå®šä¹‰ã€‚
* **ç›²åŒºäº’è¡¥**ï¼šé€šè¿‡å¤šé›·è¾¾å åŠ ï¼Œæ¶ˆé™¤æˆ¿é—´å†…çš„æ¢æµ‹æ­»è§’ã€‚

### 3. ğŸ›¡ï¸ çµæ´»çš„åŒºåŸŸç®¡ç†ï¼ˆZones Managerï¼‰
æ‰€æœ‰åŒºåŸŸæ”¯æŒä»»æ„å¤šè¾¹å½¢ï¼Œçµæ´»çš„ç¼–è¾‘æ–¹å¼ï¼Œè®©ä½ è½»æ¾ç®¡ç†åŒºåŸŸ
* **é›·è¾¾ç›‘æµ‹åŒº (Monitor Zones)**ï¼šå¯ä»¥ä¸ºæ¯ä¸ªé›·è¾¾å•ç‹¬è®¾ç½®ç›‘æµ‹åŒºï¼Œåªæœ‰è¿›å…¥è¯¥åŒºåŸŸæ‰ä¼šè§¦å‘è¯¥é›·è¾¾çš„ç›®æ ‡èåˆä¸æ˜¾ç¤ºï¼›å¦‚æœä¸è®¾ç½®åˆ™é»˜è®¤å…¨å±€èåˆã€‚
* **å…¨å±€ç›‘æµ‹åŒº (Detect Zones)**ï¼š**è‡ªåŠ¨åŒ–ç¥å™¨ï¼** åœ¨æˆ·å‹å›¾ä¸Šè‡ªç”±è®¾ç½®ç›‘æµ‹åŒºï¼Œå½“èåˆç›®æ ‡è¿›å…¥è¯¥åŒºåŸŸåï¼Œä¼šè§¦å‘HAçš„å®ä½“ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰ã€‚åŒæ—¶ï¼Œå¯ä»¥è‡ªå®šä¹‰è§¦å‘å»¶è¿Ÿï¼Œé¿å…è¯¯æŠ¥ã€‚
* **å…¨å±€æ’é™¤åŒº (Exclude Zones)**ï¼š**è§£å†³è¯¯æŠ¥çš„ç¥å™¨ï¼** åœ¨åœ°å›¾ä¸Šåœˆå‡ºé£æ‰‡ã€çª—å¸˜æˆ–ç»¿æ¤çš„ä½ç½®ï¼Œå°†å…¶è®¾ä¸ºâ€œæ’é™¤åŒºâ€ï¼Œå¼•æ“ä¼šè‡ªåŠ¨è¿‡æ»¤æ‰è¯¥åŒºåŸŸå†…çš„æ‰€æœ‰å¹²æ‰°ä¿¡å·ã€‚
* **è‡ªåŠ¨åŒ–å®ä½“**ï¼šæ¯ä¸ªå…¨å±€ç›‘æµ‹åŒº(Detect Zones)éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆå­˜åœ¨å®ä½“ï¼ˆ`binary_sensor`ï¼‰ å’Œ äººæ•°å®ä½“ï¼ˆ`sensor`ï¼‰ï¼Œè®©ä½ æ¸…æ™°çŸ¥é“åŒºåŸŸå†…æœ‰æ²¡æœ‰äººã€æœ‰å¤šå°‘äººï¼›è½»æ¾å®ç°â€œäººååœ¨æ²™å‘ä¸Šæ‰“å¼€ç”µè§†â€ã€â€œäººèµ°è¿›æµ´å®¤ä¸åŒåŒºåŸŸè°ƒæ•´ç¯å…‰â€ç­‰ç²¾ç¡®è‡ªåŠ¨åŒ–ã€‚

### 4. ğŸ“ 3D ç©ºé—´ä¿®æ­£
é’ˆå¯¹ä¾§è£…é›·è¾¾ï¼ŒRMM å†…ç½®äº† 3D ä¿®æ­£ç®—æ³•ã€‚æ ¹æ®é›·è¾¾å®‰è£…é«˜åº¦å’Œç›®æ ‡é«˜åº¦ï¼Œè‡ªåŠ¨å°†æ–œè· (Slant Range) è¿˜åŸä¸ºåœ°è· (Ground Distance)ï¼Œå¤§å¹…æé«˜å®šä½ç²¾åº¦ã€‚

---

## ğŸ› ï¸ æ”¯æŒçš„ç¡¬ä»¶

RMM å…¼å®¹æ‰€æœ‰èƒ½å¤Ÿæ¥å…¥ Home Assistant çš„æ¯«ç±³æ³¢é›·è¾¾ï¼ŒåŒ…æ‹¬1D 2D 3Dé›·è¾¾ï¼Œåªè¦å®ƒä»¬èƒ½æä¾› DISTANTCE æˆ–è€… X/Y åæ ‡æˆ–è·ç¦»æ•°æ®

* **è¿æ¥æ–¹å¼**ï¼š
    * ESPHome
    * MQTT
    * Zigbee (éœ€æ”¯æŒåæ ‡ä¸ŠæŠ¥)
* **åæ ‡å®ä½“å‘½åè§„èŒƒ**ï¼š
    * 1D é›·è¾¾ï¼šsensor.[radar_name]_distanceï¼Œ ä¾‹å¦‚ï¼šsensor.rd_ld2410_distance
    * 2D/3D é›·è¾¾ï¼šsensor.[radar_name]_target_?_x ã€ sensor.[radar_name]_target_y ã€ sensor.[radar_name]_target_z, ä¾‹å¦‚ï¼šsensor.rd_ld6004_target_1_x, sensor.rd_ld6004_target_1_y, sensor.rd_ld6004_target_1_z
    * é›·è¾¾ç›®æ ‡æ•°[å¯é€‰]ï¼šsensor.[radar_name]_presence_target_countï¼Œ ä¾‹å¦‚ï¼šsensor.rd_ld2450_presence_target_count

---

## ğŸ“¦ å®‰è£…æ–¹æ³•

### æ–¹å¼ä¸€ï¼šHACS è‡ªåŠ¨å®‰è£… (æ¨è)
1.  æ‰“å¼€ HACS -> Integrationsã€‚
2.  ç‚¹å‡»å³ä¸Šè§’èœå• -> **Custom repositories**ã€‚
3.  å¡«å…¥æœ¬ä»“åº“åœ°å€ `https://github.com/Moe8383/radar_map_manager_repo`ï¼Œç±»åˆ«é€‰æ‹© **Integration**ã€‚
4.  æœç´¢ "Radar Map Manager" å¹¶ç‚¹å‡»å®‰è£…ã€‚
5.  é‡å¯ Home Assistantã€‚

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£…
1.  ä¸‹è½½æœ¬ä»“åº“çš„ `custom_components/radar_map_manager` æ–‡ä»¶å¤¹ã€‚
2.  å°†å…¶å¤åˆ¶åˆ°æ‚¨ HA é…ç½®ç›®å½•ä¸‹çš„ `custom_components/` ä¸­ã€‚
3.  é‡å¯ Home Assistantã€‚

---

## âš™ï¸ é…ç½®æŒ‡å—

### ç¬¬ä¸€æ­¥ï¼šæ·»åŠ é›†æˆ
1.  å‰å¾€ **é…ç½®** -> **è®¾å¤‡ä¸æœåŠ¡** -> **æ·»åŠ é›†æˆ**ã€‚
2.  æœç´¢ **Radar Map Manager** å¹¶æ·»åŠ ã€‚

### ç¬¬äºŒæ­¥ï¼šæ·»åŠ å¡ç‰‡
1.  åœ¨ä»ªè¡¨ç›˜ç‚¹å‡»â€œç¼–è¾‘ä»ªè¡¨ç›˜â€ -> â€œæ·»åŠ å¡ç‰‡â€ã€‚
2.  æœç´¢ **Radar Map Manager** å¡ç‰‡ã€‚
3.  æˆ–è€…ä½¿ç”¨ä»¥ä¸‹ YAML é…ç½®ï¼š

ç‹¬ç«‹ä½¿ç”¨ï¼ˆmanual-cardï¼‰ï¼š
```yaml
type: custom:radar-map-card
map_group: default                     # å¯é€‰ï¼Œæˆ·å‹å›¾/æ¥¼å±‚åç§°ï¼Œé»˜è®¤default
read_only: false                       # å¯é€‰ï¼Œtrueä¸ºç¼–è¾‘æ¨¡å¼ï¼Œfalseä¸ºå±•ç¤ºæ¨¡å¼ï¼Œé»˜è®¤false
bg_image: /local/floorplan/house.png   # ç¼–è¾‘æ¨¡å¼ä¸‹å¿…å¡«ï¼Œæˆ·å‹å›¾å›¾ç‰‡
target_radius: 5                       # å¯é€‰ï¼Œèåˆç›®æ ‡å¤§å°
show_labels: true                      # å¯é€‰ï¼Œæ˜¾ç¤ºåŒºåŸŸåç§°
handle_radius: 1.5                     # å¯é€‰ï¼ŒåŒºåŸŸç«¯ç‚¹å¤§å°
handle_stroke: 0.2                     # å¯é€‰ï¼ŒåŒºåŸŸæ¿€æ´»ç«¯ç‚¹å¤§å°
zone_stroke: 0.5                       # å¯é€‰ï¼ŒåŒºåŸŸçº¿æ¡ç²—ç»†
label_size: 2                          # å¯é€‰ï¼ŒåŒºåŸŸåç§°å­—ä½“å¤§å°
target_colors:                         # å¯é€‰ï¼Œé›·è¾¾åŸå§‹ç›®æ ‡è‡ªå®šä¹‰é¢œè‰²
  - yellow
  - "#00FFFF"
  - "#FF00FF"
```
åœ¨picture-elementså¡ç‰‡ä¸­ä½¿ç”¨ï¼š
```yaml
type: picture-elements
image: /local/floorplan/3dplan/blank_floor.png
elements:
  - type: custom:radar-map-card
    target_radius: 5
    read_only: true
    style:
      top: 50%
      left: 50%
      width: 100%
      height: 100%
      transform: translate(-50%, -50%)
      pointer-events: none
```

---

## ç¼–è¾‘æ¨¡å¼ä½¿ç”¨æŒ‡å—

ç‚¹å‡»å¡ç‰‡å³ä¸Šè§’çš„âš™ï¸ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼

### é›·è¾¾å¸ƒå±€ï¼ˆLAYOUTï¼‰

![LAYOUT](images/layout_1.png)

#### 1. æ·»åŠ é›·è¾¾

ç‚¹å‡» + å·ï¼Œè¾“å…¥åœ¨HAä¸­çš„é›·è¾¾åç§°ï¼Œå¦‚é›·è¾¾çš„åæ ‡ä¸º sensor.rd_ld2450_target_1_xï¼Œåˆ™è¾“å…¥é›·è¾¾åç§°ï¼šrd_ld2450



